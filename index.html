<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Javascript-sdk-design by huei90</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Javascript-sdk-design</h1>
      <h2 class="project-tagline">Javascript SDK design guide extracted from work and personal experience</h2>
      <a href="https://github.com/huei90/javascript-sdk-design" class="btn">View on GitHub</a>
      <a href="https://github.com/huei90/javascript-sdk-design/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/huei90/javascript-sdk-design/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="javascript-sdk-design-guide" class="anchor" href="#javascript-sdk-design-guide" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>JavaScript SDK Design Guide</h1>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h2>

<p>This guide gives you an introduction to developing a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript</a> SDK on desktop and mobile web in different platforms and browsers (&lt;99.99% I might skip some browsers), for those developed for non-browser supports (hardware, embedded, node/io js) are excluded in this document and will be considered in the future.</p>

<p>Since I didn't find out a better documentation for the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">JavaScript</a> SDK,
I'm here to gather and note down the knowledge of my personal experiences. <strong>JavaScript-SDK-Design</strong> is not just about SDK only, it's the connection between user and browser machine. The more native we write, the more we think, we do care about the performances and differences between platforms and browsers.</p>

<p>Feel free to <a href="https://github.com/huei90/JavaScript-sdk-design/edit/master/README.md">edit</a> or you can drop me suggestions on the <a href="https://github.com/huei90/JavaScript-sdk-design/issues">issue list</a>.</p>

<p align="right">
<i>READ IT</i> 
<a href="http://sdk-design.js.org">ONLINE</a> /
<a href="https://gitprint.com/huei90/javascript-sdk-design/blob/master/README.md">PDF</a>
<i>OR</i> 
<a href="http://ctt.ec/GyjRN" title="Click to Tweet">Tweet It</a> <br>
</p>









<hr>

<h2>
<a id="content" class="anchor" href="#content" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Content</h2>

<ul>
<li><a href="#what-is-sdk">What is SDK</a></li>
<li><a href="#design-philosophy">Design Philosophy</a></li>
<li><a href="#scope">Scope</a></li>
<li>
<a href="#include-the-sdk">Include the SDK</a>

<ul>
<li><a href="#asynchronous-syntax">Asynchronous Syntax</a></li>
<li><a href="#traditional-syntax">Traditional Syntax</a></li>
<li><a href="#comparison">Comparison</a></li>
<li><a href="#problem-of-asynchronous">Problem of Asynchronous</a></li>
<li><a href="#others">Others</a></li>
</ul>
</li>
<li><a href="#sdk-versioning">SDK Versioning</a></li>
<li><a href="#changelog-document">Changelog Document</a></li>
<li><a href="#namespace">Namespace</a></li>
<li>
<a href="#storage-mechanism">Storage Mechanism</a>

<ul>
<li>
<a href="#cookie">Cookie</a>

<ul>
<li><a href="#check-cookie-writable">Check Cookie Writable</a></li>
<li><a href="#check-third-party-cookie-writable">Check Third Party Cookie Writable</a></li>
<li><a href="#write-read-remove-cookie-code">Write Read Remove Cookie Code</a></li>
</ul>
</li>
<li><a href="#session">Session</a></li>
<li>
<a href="#localstorage">LocalStorage</a>

<ul>
<li><a href="#check-localstorage-writable">Check LocalStorage Writable</a></li>
</ul>
</li>
<li>
<a href="#session-storage">Session Storage</a>

<ul>
<li><a href="#check-sessionstorage-writable">Check SessionStorage Writable</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#event">Event</a>

<ul>
<li><a href="#document-ready">Document Ready</a></li>
<li><a href="#message-event">Message Event</a></li>
<li><a href="#orientation-change">Orientation Change</a></li>
<li><a href="#disable-scroll">Disable Scroll</a></li>
</ul>
</li>
<li>
<a href="#request">Request</a>

<ul>
<li><a href="#image-beacon">Image Beacon</a></li>
<li><a href="#single-post">Single Post</a></li>
<li><a href="#multiple-post">Multiple Post</a></li>
<li><a href="#iframe">Iframe</a></li>
<li><a href="#script-jsonp">Script jsonp</a></li>
<li><a href="#navigatorsendbeacon">Navigator.sendBeacon()</a></li>
<li><a href="#xmlhttprequest">XMLHttpRequest</a></li>
<li><a href="#fragment-identifier">Fragment Identifier</a></li>
<li><a href="#maximum-number-of-connection">Maximum Number of Connection</a></li>
</ul>
</li>
<li>
<a href="#component-of-uri">Component of URI</a>

<ul>
<li><a href="#parsing-uri">Parsing URI</a></li>
</ul>
</li>
<li>
<a href="#debugging">Debugging</a>

<ul>
<li><a href="#simulating-multiple-domains">Simulating Multiple Domains</a></li>
<li><a href="#developer-tools">Developer Tools</a></li>
<li><a href="#console-logs">Console Logs</a></li>
<li><a href="#debugging-proxy">Debugging Proxy</a></li>
<li><a href="#browsersync">BrowserSync</a></li>
</ul>
</li>
<li>
<a href="#tips-and-tricks">Tips and Tricks</a>

<ul>
<li><a href="#piggyback">Piggyback</a></li>
<li><a href="#page-visibility-api">Page Visibility API</a></li>
<li><a href="#document-referrer">Document Referrer</a></li>
<li><a href="#console-logs-polyfill">Console Logs Polyfill</a></li>
<li><a href="#encodeuri-or-encodeuricomponent">EncodeURI or EncodeURIComponent</a></li>
<li><a href="#you-might-not-need-jquery">YOU MIGHT NOT NEED JQUERY</a></li>
<li><a href="#you-dont-need-jquery">You Don't Need jQuery</a></li>
<li><a href="#load-script-with-callback">Load Script with Callback</a></li>
<li><a href="#once-function">Once Function</a></li>
<li><a href="#pixel-ratio-density">Pixel Ratio Density</a></li>
<li><a href="#get-style-value">Get Style Value</a></li>
<li><a href="#check-if-element-in-viewport">Check if Element in Viewport</a></li>
<li><a href="#check-if-element-is-visible">Check if Element is Visible</a></li>
<li><a href="#get-viewport-size">Get Viewport Size</a></li>
</ul>
</li>
<li>
<a href="#wtf">WTF</a>

<ul>
<li><a href="#misspelling-of-referrer">Misspelling Of Referrer</a></li>
</ul>
</li>
<li><a href="#template">Template</a></li>
<li><a href="#booknice-to-read">Book to Read</a></li>
<li><a href="#reference">Reference</a></li>
</ul>

<h2>
<a id="what-is-sdk" class="anchor" href="#what-is-sdk" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is SDK</h2>

<p>I know it's very common, but it is.</p>

<p>"Short for <strong>software development kit</strong>, a programming package that enables a programmer to develop applications for a specific platform. Typically an SDK includes one or more APIs, programming tools, and documentation."</p>

<h2>
<a id="design-philosophy" class="anchor" href="#design-philosophy" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Design Philosophy</h2>

<p>It depends on your purpose of your SDK service and usage,
but there must be <strong>native</strong>, <strong>short</strong>, <strong>fast</strong>, <strong>clean</strong>, <strong>readable</strong> and <strong>testable</strong>.</p>

<p>Written in native JavaScript code, compiler language like
Livescript, Coffeescript, Typescript and others are <strong>not</strong> recommend.
There must be a better way to write your own JavaScript code in native faster than others.</p>

<p>Please <strong>don't</strong> involve jQuery in your SDK unless it's really important,
you can have other jQuery-like libraries, zepto.js, for the DOM manipulation.
Or if you need the HTTP <a href="https://github.com/huei90/JavaScript-sdk-design#request">ajax request</a>, use another light library like <code>window.fetch</code>.</p>

<p>Once every SDK version released, make sure that it can be fitted into older and newer SDK version in the future.
Hence, remember to write your <strong>Documentation</strong> for your SDK, comment in your code, unit test and user scenario test.</p>

<h2>
<a id="scope" class="anchor" href="#scope" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Scope</h2>

<p><em>Based on the book <a href="http://thirdpartyjs.com">Third-Party JavaScript</a></em></p>

<p>In which case, you should design a JavaScript SDK for your application?</p>

<ol>
<li>
<a href="https://github.com/huei90/javascript-sdk-design/blob/master/SCOPE.md#embedded-widgets">Embedded widgets</a> - Small interactive applications embedded on the publisher's web page (Disqus, Google Maps, Facebook Widget)</li>
<li>
<a href="https://github.com/huei90/javascript-sdk-design/blob/master/SCOPE.md#analytics-and-metrics">Analytics and metrics</a> - For gathering intelligence about visitors and how they interact with the publisher's website (GA, Flurry, Mixpanel)</li>
<li>
<a href="https://github.com/huei90/javascript-sdk-design/blob/master/SCOPE.md#web-service-api-wrappers">Web service API wrappers</a> - For developing client-side applications that communicate with external web services. (Facebook Graph API)</li>
</ol>

<p>In what case we should use SDK in JavaScript environment? <a href="https://github.com/huei90/JavaScript-sdk-design/edit/master/README.md">Suggest one</a>.</p>

<h2>
<a id="include-the-sdk" class="anchor" href="#include-the-sdk" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Include the SDK</h2>

<p>You are suggested to use <strong>Asynchronous Syntax</strong> for your script loaded.
We want to optimize the user experience on the website as we don't want our SDK library to interfere the main web loaded.</p>

<h3>
<a id="asynchronous-syntax" class="anchor" href="#asynchronous-syntax" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Asynchronous Syntax</h3>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">&lt;<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">  (<span class="pl-k">function</span> () {</span>
<span class="pl-s1">    <span class="pl-k">var</span> s <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">s</span>.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>text/javascript<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1">    <span class="pl-smi">s</span>.<span class="pl-smi">async</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;</span>
<span class="pl-s1">    <span class="pl-smi">s</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxx.com/sdk.js<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1">    <span class="pl-k">var</span> x <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];</span>
<span class="pl-s1">    <span class="pl-smi">x</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(s, x);</span>
<span class="pl-s1">  })();</span>
<span class="pl-s1">&lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<p>Target on the modern browser, you can use <code>async</code>.</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">async</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>http://xxx.com/sdk.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre></div>

<h3>
<a id="traditional-syntax" class="anchor" href="#traditional-syntax" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Traditional Syntax</h3>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>http://xxx.com/sdk.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre></div>

<h3>
<a id="comparison" class="anchor" href="#comparison" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Comparison</h3>

<p>Here's the simple graph to show the differentiate between Asynchronous and Traditional Syntax.</p>

<p>Asynchronous:</p>

<pre><code> |----A-----|
    |-----B-----------|
        |-------C------|
</code></pre>

<p>Synchronous:</p>

<pre><code>|----A-----||-----B-----------||-------C------|
</code></pre>

<p>Asynchronous and deferred JavaScript execution explained</p>

<p><img src="http://peter.sh/wp-content/uploads/2010/09/execution2.jpg"></p>

<blockquote>
<p><em><a href="https://developers.google.com/speed/docs/insights/BlockingJS">https://developers.google.com/speed/docs/insights/BlockingJS</a></em> <br>
You should avoid and minimize the use of blocking JavaScript, especially external scripts that must be fetched before they can be executed. Scripts that are necessary to render page content can be inlined to avoid extra network requests, however the inlined content needs to be small and must execute quickly to deliver good performance. Scripts that are not critical to initial render should be made asynchronous or deferred until after the first render.</p>
</blockquote>

<h3>
<a id="problem-of-asynchronous" class="anchor" href="#problem-of-asynchronous" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Problem of Asynchronous</h3>

<p>When you are using Asynchronous,
you cannot execute your SDK function which script written within the page.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&lt;</span>script<span class="pl-k">&gt;</span>
  (<span class="pl-k">function</span> () {
    <span class="pl-k">var</span> s <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>);
    <span class="pl-smi">s</span>.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>text/javascript<span class="pl-pds">'</span></span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">async</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxx.com/sdk.js<span class="pl-pds">'</span></span>;
    <span class="pl-k">var</span> x <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];
    <span class="pl-smi">x</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(s, x);
  })();

  <span class="pl-c">// execute your script immediately here</span>
  <span class="pl-en">SDKName</span>(<span class="pl-s"><span class="pl-pds">'</span>some arguments<span class="pl-pds">'</span></span>);
<span class="pl-k">&lt;</span><span class="pl-k">/</span>script<span class="pl-k">&gt;</span></pre></div>

<p>The result will lead to undefined because the <code>SDKName()</code> execute before the script loaded,
therefore we should do some tricks and make sure the script execute successfully.
The event will store in the <code>SDKName.q</code> queue array,
your SDK should handle and execute <code>SDKName.q</code> and reinitial the namespace <code>SDKName</code>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&lt;</span>script<span class="pl-k">&gt;</span>
  (<span class="pl-k">function</span> () {
    <span class="pl-c">// add a queue event here</span>
    SDKName <span class="pl-k">=</span> SDKName <span class="pl-k">||</span> <span class="pl-k">function</span> () {
      (<span class="pl-smi">SDKName</span>.<span class="pl-smi">q</span> <span class="pl-k">=</span> <span class="pl-smi">SDKName</span>.<span class="pl-smi">q</span> <span class="pl-k">||</span> []).<span class="pl-c1">push</span>(<span class="pl-v">arguments</span>);
    };
    <span class="pl-k">var</span> s <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>);
    <span class="pl-smi">s</span>.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>text/javascript<span class="pl-pds">'</span></span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">async</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxx.com/sdk.js<span class="pl-pds">'</span></span>;
    <span class="pl-k">var</span> x <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];
    <span class="pl-smi">x</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(s, x);
  })();

  <span class="pl-c">// execute your script immediately here</span>
  <span class="pl-en">SDKName</span>(<span class="pl-s"><span class="pl-pds">'</span>some arguments<span class="pl-pds">'</span></span>);
<span class="pl-k">&lt;</span><span class="pl-k">/</span>script<span class="pl-k">&gt;</span></pre></div>

<p><strong>Or</strong> using [].push</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&lt;</span>script<span class="pl-k">&gt;</span>
  (<span class="pl-k">function</span> () {
    <span class="pl-c">// add a queue event here</span>
    SDKName <span class="pl-k">=</span> <span class="pl-c1">window</span>.<span class="pl-smi">SDKName</span> <span class="pl-k">||</span> (<span class="pl-c1">window</span>.<span class="pl-smi">SDKName</span> <span class="pl-k">=</span> []);
    <span class="pl-k">var</span> s <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>);
    <span class="pl-smi">s</span>.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>text/javascript<span class="pl-pds">'</span></span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">async</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxx.com/sdk.js<span class="pl-pds">'</span></span>;
    <span class="pl-k">var</span> x <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];
    <span class="pl-smi">x</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(s, x);
  })();

  <span class="pl-c">// execute your script immediately here</span>
  <span class="pl-smi">SDKName</span>.<span class="pl-c1">push</span>([<span class="pl-s"><span class="pl-pds">'</span>some arguments<span class="pl-pds">'</span></span>]);
<span class="pl-k">&lt;</span><span class="pl-k">/</span>script<span class="pl-k">&gt;</span></pre></div>

<h3>
<a id="others" class="anchor" href="#others" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Others</h3>

<p>There are other different ways to include a script</p>

<p><strong>Import in ES2015</strong></p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">import</span> <span class="pl-s"><span class="pl-pds">"</span>your-sdk<span class="pl-pds">"</span></span>;</pre></div>

<p><strong>Modular include a Script</strong></p>

<p>For full source code, see this awesome tutorial. <a href="https://libraryinstitute.wordpress.com/2010/12/01/loading-javascript-modules/">Loading JavaScript Modules</a></p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">module</span>(<span class="pl-s"><span class="pl-pds">'</span>sdk.js<span class="pl-pds">'</span></span>,[<span class="pl-s"><span class="pl-pds">'</span>sdk-track.js<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>sdk-beacon.js<span class="pl-pds">'</span></span>],<span class="pl-k">function</span>(<span class="pl-smi">track</span>, <span class="pl-smi">beacon</span>) {
  <span class="pl-c">// sdk definitions, split into local and global/exported definitions</span>
  <span class="pl-c">// local definitions</span>
  <span class="pl-c">// exports</span>
});

<span class="pl-c">// you should contain this "module" method</span>
(<span class="pl-k">function</span> () {

  <span class="pl-k">var</span> modules <span class="pl-k">=</span> {}; <span class="pl-c">// private record of module data</span>

  <span class="pl-c">// modules are functions with additional information</span>
  <span class="pl-k">function</span> <span class="pl-en">module</span>(<span class="pl-smi">name</span>,<span class="pl-smi">imports</span>,<span class="pl-smi">mod</span>) {

    <span class="pl-c">// record module information</span>
    <span class="pl-c1">window</span>.<span class="pl-smi">console</span>.<span class="pl-en">log</span>(<span class="pl-s"><span class="pl-pds">'</span>found module <span class="pl-pds">'</span></span><span class="pl-k">+</span>name);
    modules[name] <span class="pl-k">=</span> {name<span class="pl-k">:</span>name, imports<span class="pl-k">:</span> imports, mod<span class="pl-k">:</span> mod};

    <span class="pl-c">// trigger loading of import dependencies</span>
    <span class="pl-k">for</span> (<span class="pl-k">var</span> imp <span class="pl-k">in</span> imports) <span class="pl-en">loadModule</span>(imports[imp]);

    <span class="pl-c">// check whether this was the last module to be loaded</span>
    <span class="pl-c">// in a given dependency group</span>
    <span class="pl-en">loadedModule</span>(name);
  }

  <span class="pl-c">// function loadModule</span>
  <span class="pl-c">// function loadedModule</span>

  <span class="pl-c1">window</span>.<span class="pl-smi">module</span> <span class="pl-k">=</span> <span class="pl-c1">module</span>;
})();</pre></div>

<h2>
<a id="sdk-versioning" class="anchor" href="#sdk-versioning" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SDK Versioning</h2>

<p>Please avoid using your special case for version like <code>brand-v&lt;timestamp&gt;.js</code> <code>brand-v&lt;datetime&gt;.js</code> <code>brand-v1-v2.js</code>,
it may cause the developer who use the SDK on confusing which is the latest version.</p>

<p>Use <a href="http://semver.org">Semantic Versioning</a> to define your SDK Version in the form "MAJOR.MINOR.PATCH".
Version in <code>v1.0.0</code> <code>v1.5.0</code> <code>v2.0.0</code> is easier for them to trace and search for the changelog documentation.</p>

<p>Normally, we can have different ways to state the SDK version, it depends on your service and design.</p>

<p>Using Query String path.</p>

<pre><code>http://xxx.com/sdk.js?v=1.0.0
</code></pre>

<p>Using the Folder Naming.</p>

<pre><code>http://xxx.com/v1.0.0/sdk.js
</code></pre>

<p>Using hostname (subdomain).</p>

<pre><code>http://v1.xxx.com/sdk.js
</code></pre>

<p>For the further development, you are advised to use  <code>stable</code> <code>unstable</code> <code>alpha</code> <code>latest</code> <code>experimental</code> version.</p>

<pre><code>http://xxx.com/sdk-stable.js
http://xxx.com/sdk-unstable.js
http://xxx.com/sdk-alpha.js
http://xxx.com/sdk-latest.js
http://xxx.com/sdk-experimental.js
</code></pre>

<h2>
<a id="changelog-document" class="anchor" href="#changelog-document" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Changelog Document</h2>

<p>You should notice that your SDK user will not know if you upgrade your SDK without announcement.
Remember to write a changelog to document your major, minor and even bug fix change.
It will be a good developer experience if we can trace the changing API for the SDK. - <a href="http://keepachangelog.com">Keep a Changelog</a> (<a href="https://github.com/olivierlacan/keep-a-changelog">Github Repo</a>)</p>

<p>Each version should have:</p>

<pre><code>[Added] for new features.
[Changed] for changes in existing functionality.
[Deprecated] for once-stable features removed in upcoming releases.
[Removed] for deprecated features removed in this release.
[Fixed] for any bug fixes.
[Security] to invite users to upgrade in case of vulnerabilities.
</code></pre>

<p>In addition, <a href="https://github.com/dannyfritz/commit-message-emoji">commit-message-emoji</a> uses emoji to explain the commit's changes itself.</p>

<h2>
<a id="namespace" class="anchor" href="#namespace" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Namespace</h2>

<p>You should not define more than one global namespace in your SDK and
prevent using the common word for your namespace to avoid collision with other libraries.</p>

<p>On your SDK mainland, you should use <code>(function () { ... })()</code> to wrap all your source.</p>

<p>This is an increasingly common practice, employed by many popular JavaScript libraries (jQuery, Node.js, etc.). This technique creates a closure around the entire contents of the file which, perhaps most importantly, creates a private namespace and thereby helps avoid potential name clashes between different JavaScript modules and libraries. <a href="http://www.toptal.com/javascript/interview-questions">#</a></p>

<p>To avoid <strong>namespace collision</strong></p>

<p>Learning this from Google Analytics, you can define your namespace by changing the value <code>ga</code></p>

<div class="highlight highlight-source-js"><pre>(<span class="pl-k">function</span>(<span class="pl-smi">i</span>,<span class="pl-smi">s</span>,<span class="pl-smi">o</span>,<span class="pl-smi">g</span>,<span class="pl-smi">r</span>,<span class="pl-smi">a</span>,<span class="pl-smi">m</span>){i[<span class="pl-s"><span class="pl-pds">'</span>GoogleAnalyticsObject<span class="pl-pds">'</span></span>]<span class="pl-k">=</span>r;i[r]<span class="pl-k">=</span>i[r]<span class="pl-k">||</span><span class="pl-k">function</span>(){
(i[r].<span class="pl-smi">q</span><span class="pl-k">=</span>i[r].<span class="pl-smi">q</span><span class="pl-k">||</span>[]).<span class="pl-c1">push</span>(<span class="pl-v">arguments</span>)},i[r].<span class="pl-smi">l</span><span class="pl-k">=</span><span class="pl-c1">1</span><span class="pl-k">*</span><span class="pl-k">new</span> <span class="pl-en">Date</span>();a<span class="pl-k">=</span><span class="pl-smi">s</span>.<span class="pl-c1">createElement</span>(o),
m<span class="pl-k">=</span><span class="pl-smi">s</span>.<span class="pl-c1">getElementsByTagName</span>(o)[<span class="pl-c1">0</span>];<span class="pl-smi">a</span>.<span class="pl-smi">async</span><span class="pl-k">=</span><span class="pl-c1">1</span>;<span class="pl-smi">a</span>.<span class="pl-smi">src</span><span class="pl-k">=</span>g;<span class="pl-smi">m</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(a,m)
})(<span class="pl-c1">window</span>,<span class="pl-c1">document</span>,<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>//www.google-analytics.com/analytics.js<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>ga<span class="pl-pds">'</span></span>);</pre></div>

<p>From <a href="http://docs.openx.com/ad_server/adtags_namespace.html">OpenX experience</a>, support a parameter to request the namespace.</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>http://your_domain/sdk?namespace=yourcompany<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre></div>

<h2>
<a id="storage-mechanism" class="anchor" href="#storage-mechanism" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Storage Mechanism</h2>

<h3>
<a id="cookie" class="anchor" href="#cookie" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Cookie</h3>

<p>The domain scope of using cookie is quite complex while involving the <code>subdomain</code> and <code>path</code>.</p>

<p>For <code>path=/</code>,
you have a cookie <code>first=value1</code> in domain <code>http://github.com</code>,
another cookie <code>second=value2</code> in domain <code>http://sub.github.com</code></p>

<table>
<thead>
<tr>
<th align="center"></th>
<th align="center"><a href="http://github.com">http://github.com</a></th>
<th align="center"><a href="http://sub.github.com">http://sub.github.com</a></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">first=value1</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="center">second=value2</td>
<td align="center">✘</td>
<td align="center">✓</td>
</tr>
</tbody>
</table>

<p>You have a cookie <code>first=value1</code> in domain <code>http://github.com</code>,
cookie <code>second=value2</code> in domain path <code>http://github.com/path1</code>
and cookie <code>third=value3</code> in domain <code>http://sub.github.com</code>,</p>

<table>
<thead>
<tr>
<th align="center"></th>
<th align="center"><a href="http://github.com">http://github.com</a></th>
<th align="center"><a href="http://github.com/path1">http://github.com/path1</a></th>
<th align="center"><a href="http://sub.github.com">http://sub.github.com</a></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">first=value1</td>
<td align="center">✓</td>
<td align="center">✓</td>
<td align="center">✓</td>
</tr>
<tr>
<td align="center">second=value2</td>
<td align="center">✘</td>
<td align="center">✓</td>
<td align="center">✘</td>
</tr>
<tr>
<td align="center">third=value3</td>
<td align="center">✘</td>
<td align="center">✘</td>
<td align="center">✓</td>
</tr>
</tbody>
</table>

<h4>
<a id="check-cookie-writable" class="anchor" href="#check-cookie-writable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check Cookie Writable</h4>

<p>Given a domain (Default as current hostname), check whether the cookie is writable.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">checkCookieWritable</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">domain</span>) {
    <span class="pl-k">try</span> {
        <span class="pl-c">// Create cookie</span>
        <span class="pl-c1">document</span>.<span class="pl-c1">cookie</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>cookietest=1<span class="pl-pds">'</span></span> <span class="pl-k">+</span> (domain <span class="pl-k">?</span> <span class="pl-s"><span class="pl-pds">'</span>; domain=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> domain <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>);
        <span class="pl-k">var</span> ret <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">cookie</span>.<span class="pl-c1">indexOf</span>(<span class="pl-s"><span class="pl-pds">'</span>cookietest=<span class="pl-pds">'</span></span>) <span class="pl-k">!=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;
        <span class="pl-c">// Delete cookie</span>
        <span class="pl-c1">document</span>.<span class="pl-c1">cookie</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT<span class="pl-pds">'</span></span> <span class="pl-k">+</span> (domain <span class="pl-k">?</span> <span class="pl-s"><span class="pl-pds">'</span>; domain=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> domain <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>);
        <span class="pl-k">return</span> ret;
    } <span class="pl-k">catch</span> (e) {
        <span class="pl-k">return</span> <span class="pl-c1">false</span>;
    }
};</pre></div>

<h4>
<a id="check-third-party-cookie-writable" class="anchor" href="#check-third-party-cookie-writable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check Third Party Cookie Writable</h4>

<p>It's impossible to check only using client side JavaScript, you need a server to do that. (<a href="https://dl.dropboxusercontent.com/u/105727/web/3rd/third-party-cookies.html">Example</a>)</p>

<h4>
<a id="write-read-remove-cookie-code" class="anchor" href="#write-read-remove-cookie-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Write Read Remove Cookie Code</h4>

<p>Snippet Code for write/read/remove cookie script.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> cookie <span class="pl-k">=</span> {
    <span class="pl-en">write</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">name</span>, <span class="pl-smi">value</span>, <span class="pl-smi">days</span>, <span class="pl-smi">domain</span>, <span class="pl-smi">path</span>) {
        <span class="pl-k">var</span> date <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Date</span>();
        days <span class="pl-k">=</span> days <span class="pl-k">||</span> <span class="pl-c1">730</span>; <span class="pl-c">// two years</span>
        path <span class="pl-k">=</span> path <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span>;
        <span class="pl-smi">date</span>.<span class="pl-c1">setTime</span>(<span class="pl-smi">date</span>.<span class="pl-c1">getTime</span>() <span class="pl-k">+</span> (days <span class="pl-k">*</span> <span class="pl-c1">24</span> <span class="pl-k">*</span> <span class="pl-c1">60</span> <span class="pl-k">*</span> <span class="pl-c1">60</span> <span class="pl-k">*</span> <span class="pl-c1">1000</span>));
        <span class="pl-k">var</span> expires <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>; expires=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">date</span>.<span class="pl-c1">toGMTString</span>();
        <span class="pl-k">var</span> cookieValue <span class="pl-k">=</span> name <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> value <span class="pl-k">+</span> expires <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>; path=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> path;
        <span class="pl-k">if</span> (domain) {
            cookieValue <span class="pl-k">+=</span> <span class="pl-s"><span class="pl-pds">'</span>; domain=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> domain;
        }
        <span class="pl-c1">document</span>.<span class="pl-c1">cookie</span> <span class="pl-k">=</span> cookieValue;
    },
    <span class="pl-en">read</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">name</span>) {
        <span class="pl-k">var</span> allCookie <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-c1">document</span>.<span class="pl-c1">cookie</span>;
        <span class="pl-k">var</span> index <span class="pl-k">=</span> <span class="pl-smi">allCookie</span>.<span class="pl-c1">indexOf</span>(name);
        <span class="pl-k">if</span> (name <span class="pl-k">===</span> <span class="pl-c1">undefined</span> <span class="pl-k">||</span> name <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span> <span class="pl-k">||</span> index <span class="pl-k">===</span> <span class="pl-k">-</span><span class="pl-c1">1</span>) <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>;
        <span class="pl-k">var</span> ind1 <span class="pl-k">=</span> <span class="pl-smi">allCookie</span>.<span class="pl-c1">indexOf</span>(<span class="pl-s"><span class="pl-pds">'</span>;<span class="pl-pds">'</span></span>, index);
        <span class="pl-k">if</span> (ind1 <span class="pl-k">==</span> <span class="pl-k">-</span><span class="pl-c1">1</span>) ind1 <span class="pl-k">=</span> <span class="pl-smi">allCookie</span>.<span class="pl-c1">length</span>;
        <span class="pl-k">return</span> <span class="pl-c1">unescape</span>(<span class="pl-smi">allCookie</span>.<span class="pl-c1">substring</span>(index <span class="pl-k">+</span> <span class="pl-smi">name</span>.<span class="pl-c1">length</span> <span class="pl-k">+</span> <span class="pl-c1">1</span>, ind1));
    },
    <span class="pl-en">remove</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">name</span>) {
        <span class="pl-k">if</span> (<span class="pl-v">this</span>.<span class="pl-en">read</span>(name)) {
            <span class="pl-v">this</span>.<span class="pl-c1">write</span>(name, <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>, <span class="pl-k">-</span><span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span>);
        }
    }
};</pre></div>

<h3>
<a id="session" class="anchor" href="#session" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Session</h3>

<p>It's important to know that JavaScript is <strong>not possible</strong> to write Session,
please refer to the server side team to implement Session.</p>

<p>A page session lasts for as long as the browser is open and survives over page reloads and restores. Opening a page in a new tab or window will cause a new session to be initiated.</p>

<h3>
<a id="localstorage" class="anchor" href="#localstorage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LocalStorage</h3>

<p>Stores data with no expiration date, storage limit is far larger (at least 5MB) and
information is never transferred to the server.</p>

<p>It's good to know that each localStorage from <code>http</code> and <code>https</code> in the same domain aren't shared.
You can create an iframe inside the website and use <code>postMessage</code> to pass the value to others. <a href="http://stackoverflow.com/questions/10502469/is-there-any-workaround-to-make-use-of-html5-localstorage-on-both-http-and-https">HOW TO?</a></p>

<h4>
<a id="check-localstorage-writable" class="anchor" href="#check-localstorage-writable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check LocalStorage Writable</h4>

<p>window.localStorage is not support in every browser, SDK should check available before using it.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">testCanLocalStorage</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
   <span class="pl-k">var</span> mod <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>modernizr<span class="pl-pds">'</span></span>;
   <span class="pl-k">try</span> {
       <span class="pl-smi">localStorage</span>.<span class="pl-c1">setItem</span>(mod, mod);
       <span class="pl-smi">localStorage</span>.<span class="pl-c1">removeItem</span>(mod);
       <span class="pl-k">return</span> <span class="pl-c1">true</span>;
   } <span class="pl-k">catch</span> (e) {
       <span class="pl-k">return</span> <span class="pl-c1">false</span>;
   }
};</pre></div>

<h3>
<a id="session-storage" class="anchor" href="#session-storage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Session Storage</h3>

<p>Stores data for one session (data is lost when the tab is closed).</p>

<h3>
<a id="check-sessionstorage-writable" class="anchor" href="#check-sessionstorage-writable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check SessionStorage Writable</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">checkCanSessionStorage</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
  <span class="pl-k">var</span> mod <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>modernizr<span class="pl-pds">'</span></span>;
  <span class="pl-k">try</span> {
    <span class="pl-smi">sessionStorage</span>.<span class="pl-c1">setItem</span>(mod, mod);
    <span class="pl-smi">sessionStorage</span>.<span class="pl-c1">removeItem</span>(mod);
    <span class="pl-k">return</span> <span class="pl-c1">true</span>;
  } <span class="pl-k">catch</span> (e) {
    <span class="pl-k">return</span> <span class="pl-c1">false</span>;
  }
}</pre></div>

<h2>
<a id="event" class="anchor" href="#event" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Event</h2>

<p>In client browser, there are events <code>load</code> <code>unload</code> <code>on</code> <code>off</code> <code>bind</code> .... Here's some <a href="https://remysharp.com/2010/10/08/what-is-a-polyfill">polyfills</a> for you to handle all different platforms.</p>

<h3>
<a id="document-ready" class="anchor" href="#document-ready" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Document Ready</h3>

<p>Please do make sure that the entire page is finished loading(ready) before starting execution the SDK functions.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// handle IE8+</span>
<span class="pl-k">function</span> <span class="pl-en">ready</span> (<span class="pl-smi">fn</span>) {
    <span class="pl-k">if</span> (<span class="pl-c1">document</span>.<span class="pl-c1">readyState</span> <span class="pl-k">!=</span> <span class="pl-s"><span class="pl-pds">'</span>loading<span class="pl-pds">'</span></span>) {
        <span class="pl-en">fn</span>();
    } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-c1">window</span>.<span class="pl-smi">addEventListener</span>) {
        <span class="pl-c">// window.addEventListener('load', fn);</span>
        <span class="pl-c1">window</span>.<span class="pl-c1">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>DOMContentLoaded<span class="pl-pds">'</span></span>, fn);
    } <span class="pl-k">else</span> {
        <span class="pl-c1">window</span>.<span class="pl-c1">attachEvent</span>(<span class="pl-s"><span class="pl-pds">'</span>onreadystatechange<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>() {
            <span class="pl-k">if</span> (<span class="pl-c1">document</span>.<span class="pl-c1">readyState</span> <span class="pl-k">!=</span> <span class="pl-s"><span class="pl-pds">'</span>loading<span class="pl-pds">'</span></span>)
                <span class="pl-en">fn</span>();
            });
    }
}</pre></div>

<blockquote>
<p><strong>DOMContentLoaded</strong> -  fired when the document has been completely loaded and parsed, without waiting for stylesheets, images, and subframes to finish loading</p>

<p><strong>load</strong> event can be used to detect a fully-loaded page</p>

<p>Information from JS Tip - <a href="https://github.com/loverajoel/jstips/blob/gh-pages/_posts/en/2016-02-15-detect-document-ready-in-pure-js.md">https://github.com/loverajoel/jstips/blob/gh-pages/_posts/en/2016-02-15-detect-document-ready-in-pure-js.md</a></p>
</blockquote>

<h3>
<a id="message-event" class="anchor" href="#message-event" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Message Event</h3>

<p>It's about the cross-origin communication between iframe and window, read the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">API documentation</a>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// in the iframe</span>
<span class="pl-smi">parent</span>.<span class="pl-c1">postMessage</span>(<span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span>); <span class="pl-c">// string</span>

<span class="pl-c">// ==========================================</span>

<span class="pl-c">// in the iframe's parent</span>
<span class="pl-c">// Create IE + others compatible event handler</span>
<span class="pl-k">var</span> eventMethod <span class="pl-k">=</span> <span class="pl-c1">window</span>.<span class="pl-smi">addEventListener</span> <span class="pl-k">?</span> <span class="pl-s"><span class="pl-pds">"</span>addEventListener<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>attachEvent<span class="pl-pds">"</span></span>;
<span class="pl-k">var</span> eventer <span class="pl-k">=</span> <span class="pl-c1">window</span>[eventMethod];
<span class="pl-k">var</span> messageEvent <span class="pl-k">=</span> eventMethod <span class="pl-k">==</span> <span class="pl-s"><span class="pl-pds">"</span>attachEvent<span class="pl-pds">"</span></span> <span class="pl-k">?</span> <span class="pl-s"><span class="pl-pds">"</span>onmessage<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>message<span class="pl-pds">"</span></span>;

<span class="pl-c">// Listen to message from child window</span>
<span class="pl-en">eventer</span>(messageEvent,<span class="pl-k">function</span>(<span class="pl-smi">e</span>) {
  <span class="pl-c">// e.origin , check the message origin</span>
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>parent received message!:  <span class="pl-pds">'</span></span>,<span class="pl-smi">e</span>.<span class="pl-c1">data</span>);
},<span class="pl-c1">false</span>);</pre></div>

<p>The post message data should be <strong>String</strong>, for more advanced used in json, use <strong>JSON String</strong>. Although the modern browser do support <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm">Structured Clone Algorithm</a> on the parameter, but not the 100% browser.</p>

<h3>
<a id="orientation-change" class="anchor" href="#orientation-change" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Orientation Change</h3>

<p>Detect device orientation change</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">window</span>.<span class="pl-c1">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>orientationchange<span class="pl-pds">'</span></span>, fn);</pre></div>

<p>Get Orientation Rotate Degree</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">window</span>.<span class="pl-smi">orientation</span>; <span class="pl-c">// =&gt; 90, -90, 0</span></pre></div>

<p>Screen portrait-primary, portrait-secondary, landscape-primary, landscape-secondary (Experimental)</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// https://developer.mozilla.org/en-US/docs/Web/API/Screen/orientation</span>
<span class="pl-k">var</span> orientation <span class="pl-k">=</span> <span class="pl-c1">screen</span>.<span class="pl-smi">orientation</span> <span class="pl-k">||</span> <span class="pl-c1">screen</span>.<span class="pl-smi">mozOrientation</span> <span class="pl-k">||</span> <span class="pl-c1">screen</span>.<span class="pl-smi">msOrientation</span>;</pre></div>

<h3>
<a id="disable-scroll" class="anchor" href="#disable-scroll" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Disable Scroll</h3>

<p>In web page, use CSS style <code>overflow: hidden</code>, in some mobile web, this css doesn't work, use javascript event.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">document</span>.<span class="pl-c1">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>touchstart<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">e</span>){ <span class="pl-smi">e</span>.<span class="pl-c1">preventDefault</span>(); }); <span class="pl-c">// prevent scroll</span>
<span class="pl-c">// or </span>
<span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>touchstart<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">e</span>){ <span class="pl-smi">e</span>.<span class="pl-c1">preventDefault</span>(); }); <span class="pl-c">// prevent scroll</span>
<span class="pl-c">// use move if you need some touch event</span>
<span class="pl-c1">document</span>.<span class="pl-c1">addEventListener</span>(<span class="pl-s"><span class="pl-pds">'</span>touchmove<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">e</span>){ <span class="pl-smi">e</span>.<span class="pl-c1">preventDefault</span>(); }); <span class="pl-c">// prevent scroll</span></pre></div>

<h2>
<a id="request" class="anchor" href="#request" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Request</h2>

<p>The communication between our SDK and Server is using Ajax Request,
as we know we can use jQuery ajax http request to communicate with Server,
but there's a better solution to implement it.</p>

<h3>
<a id="image-beacon" class="anchor" href="#image-beacon" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Image Beacon</h3>

<p>Use the Image Beacon to ask the browser to perform a method GET Request to get an Image.</p>

<p><em>Remember to add timestamp (Cache Buster) to prevent caching in browser.</em></p>

<div class="highlight highlight-source-js"><pre>(<span class="pl-k">new</span> <span class="pl-en">Image</span>()).<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxxxx.com/collect?id=1111<span class="pl-pds">'</span></span>;</pre></div>

<p>Some notice for GET Query String, there is the limit of length which is 2048(Basically It depends on different browser and server). You should do some tricks to handle if exceed length limit.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">if</span> (length <span class="pl-k">&gt;</span> <span class="pl-c1">2048</span>) {
    <span class="pl-c">// do Multiple Post (form)</span>
} <span class="pl-k">else</span> {
    <span class="pl-c">// do Image Beacon</span>
}</pre></div>

<p>You may have the problem on <code>encodeURI</code> or <code>encodeURIComponent</code>, it's better if you understand them. <a href="#encodeuri-or-encodeuricomponent">See below</a>.</p>

<p>For the image load <strong>success/error callback</strong></p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> img <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Image</span>();
<span class="pl-smi">img</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxxxx.com/collect?id=1111<span class="pl-pds">'</span></span>;
<span class="pl-smi">img</span>.<span class="pl-smi">onload</span> <span class="pl-k">=</span> successCallback;
<span class="pl-smi">img</span>.<span class="pl-smi">onerror</span> <span class="pl-k">=</span> errorCallback;</pre></div>

<h3>
<a id="single-post" class="anchor" href="#single-post" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Single Post</h3>

<p>Use the native form element method POST to send a key value.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> form <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>form<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> input <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>input<span class="pl-pds">'</span></span>);

<span class="pl-smi">form</span>.<span class="pl-c1">style</span>.<span class="pl-c1">display</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>none<span class="pl-pds">'</span></span>;
<span class="pl-smi">form</span>.<span class="pl-c1">setAttribute</span>(<span class="pl-s"><span class="pl-pds">'</span>method<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>POST<span class="pl-pds">'</span></span>);
<span class="pl-smi">form</span>.<span class="pl-c1">setAttribute</span>(<span class="pl-s"><span class="pl-pds">'</span>action<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://xxxx.com/track<span class="pl-pds">'</span></span>);

<span class="pl-smi">input</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>username<span class="pl-pds">'</span></span>;
<span class="pl-smi">input</span>.<span class="pl-c1">value</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>attacker<span class="pl-pds">'</span></span>;

<span class="pl-smi">form</span>.<span class="pl-c1">appendChild</span>(input);
<span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>body<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>].<span class="pl-c1">appendChild</span>(form);

<span class="pl-smi">form</span>.<span class="pl-c1">submit</span>();</pre></div>

<h3>
<a id="multiple-post" class="anchor" href="#multiple-post" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multiple Post</h3>

<p>The Service is often complex, we need to send more data through method POST.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">requestWithoutAjax</span>( <span class="pl-smi">url</span>, <span class="pl-smi">params</span>, <span class="pl-smi">method</span> ){

    params <span class="pl-k">=</span> params <span class="pl-k">||</span> {};
    method <span class="pl-k">=</span> method <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>post<span class="pl-pds">"</span></span>;

    <span class="pl-c">// function to remove the iframe</span>
    <span class="pl-k">var</span> <span class="pl-en">removeIframe</span> <span class="pl-k">=</span> <span class="pl-k">function</span>( <span class="pl-smi">iframe</span> ){
        <span class="pl-smi">iframe</span>.<span class="pl-smi">parentElement</span>.<span class="pl-c1">removeChild</span>(iframe);
    };

    <span class="pl-c">// make a iframe...</span>
    <span class="pl-k">var</span> iframe <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>iframe<span class="pl-pds">'</span></span>);
    <span class="pl-smi">iframe</span>.<span class="pl-c1">style</span>.<span class="pl-c1">display</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>none<span class="pl-pds">'</span></span>;

    <span class="pl-smi">iframe</span>.<span class="pl-en">onload</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(){
        <span class="pl-k">var</span> iframeDoc <span class="pl-k">=</span> <span class="pl-v">this</span>.<span class="pl-smi">contentWindow</span>.<span class="pl-smi">document</span>;

        <span class="pl-c">// Make a invisible form</span>
        <span class="pl-k">var</span> form <span class="pl-k">=</span> <span class="pl-smi">iframeDoc</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>form<span class="pl-pds">'</span></span>);
        <span class="pl-smi">form</span>.<span class="pl-c1">method</span> <span class="pl-k">=</span> method;
        <span class="pl-smi">form</span>.<span class="pl-c1">action</span> <span class="pl-k">=</span> url;
        <span class="pl-smi">iframeDoc</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(form);

        <span class="pl-c">// pass the parameters</span>
        <span class="pl-k">for</span>( <span class="pl-k">var</span> name <span class="pl-k">in</span> params ){
            <span class="pl-k">var</span> input <span class="pl-k">=</span> <span class="pl-smi">iframeDoc</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>input<span class="pl-pds">'</span></span>);
            <span class="pl-smi">input</span>.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>hidden<span class="pl-pds">'</span></span>;
            <span class="pl-smi">input</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> name;
            <span class="pl-smi">input</span>.<span class="pl-c1">value</span> <span class="pl-k">=</span> params[name];
            <span class="pl-smi">form</span>.<span class="pl-c1">appendChild</span>(input);
        }

        <span class="pl-smi">form</span>.<span class="pl-c1">submit</span>();
        <span class="pl-c">// remove the iframe</span>
        <span class="pl-c1">setTimeout</span>( <span class="pl-k">function</span>(){
            <span class="pl-en">removeIframe</span>(iframe);
        }, <span class="pl-c1">500</span>);
    };

    <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(iframe);
}</pre></div>

<div class="highlight highlight-source-js"><pre><span class="pl-en">requestWithoutAjax</span>(<span class="pl-s"><span class="pl-pds">'</span>url/to<span class="pl-pds">'</span></span>, { id<span class="pl-k">:</span> <span class="pl-c1">2</span>, price<span class="pl-k">:</span> <span class="pl-c1">2.5</span>, lastname<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Gamez<span class="pl-pds">'</span></span>});</pre></div>

<h3>
<a id="iframe" class="anchor" href="#iframe" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Iframe</h3>

<p>When you need to generate a content within the page, you can use iframe to embed your html.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> iframe <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>iframe<span class="pl-pds">'</span></span>);
<span class="pl-k">var</span> body <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>body<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];

<span class="pl-smi">iframe</span>.<span class="pl-c1">style</span>.<span class="pl-c1">display</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>none<span class="pl-pds">'</span></span>;
<span class="pl-smi">iframe</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://xxxx.com/page<span class="pl-pds">'</span></span>;
<span class="pl-smi">iframe</span>.<span class="pl-en">onreadystatechange</span> <span class="pl-k">=</span> <span class="pl-k">function</span> () {
    <span class="pl-k">if</span> (<span class="pl-smi">iframe</span>.<span class="pl-c1">readyState</span> <span class="pl-k">!==</span> <span class="pl-s"><span class="pl-pds">'</span>complete<span class="pl-pds">'</span></span>) {
        <span class="pl-k">return</span>;
    }
};
<span class="pl-smi">iframe</span>.<span class="pl-smi">onload</span> <span class="pl-k">=</span> loadCallback;

<span class="pl-smi">body</span>.<span class="pl-c1">appendChild</span>(iframe);</pre></div>

<p><strong>Remove extra margin from INSIDE an iframe</strong></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">iframe</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>...<span class="pl-pds">"</span></span>
 <span class="pl-e">marginwidth</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>
 <span class="pl-e">marginheight</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>
 <span class="pl-e">hspace</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>
 <span class="pl-e">vspace</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>
 <span class="pl-e">frameborder</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span>
 <span class="pl-e">scrolling</span>=<span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">iframe</span>&gt;</pre></div>

<p><strong>Putting html content into an iframe</strong></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">iframe</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>iframe<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">iframe</span>&gt;

<span class="pl-s1">&lt;<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">  <span class="pl-k">var</span> html_string<span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>content &lt;script&gt;alert(location.href);&lt;/script&gt;<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">  <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>iframe<span class="pl-pds">'</span></span>).<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>data:text/html;charset=utf-8,<span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">escape</span>(html_string);</span>
<span class="pl-s1">  <span class="pl-c">// alert data:text/html;charset=utf-8.....</span></span>
<span class="pl-s1">  <span class="pl-c">// access cookie get ERROR</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">  <span class="pl-k">var</span> doc <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>iframe<span class="pl-pds">'</span></span>).<span class="pl-smi">contentWindow</span>.<span class="pl-smi">document</span>;</span>
<span class="pl-s1">  <span class="pl-smi">doc</span>.<span class="pl-c1">open</span>();</span>
<span class="pl-s1">  <span class="pl-smi">doc</span>.<span class="pl-c1">write</span>(<span class="pl-s"><span class="pl-pds">'</span>&lt;body&gt;Test&lt;script&gt;alert(location.href);&lt;/script&gt;&lt;/body&gt;<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">  <span class="pl-smi">doc</span>.<span class="pl-c1">close</span>();</span>
<span class="pl-s1">  <span class="pl-c">// alert "top window url"</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">  <span class="pl-k">var</span> iframe <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>iframe<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">  <span class="pl-smi">iframe</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>javascript:;<span class="pl-cce">\'</span><span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-c1">encodeURI</span>(<span class="pl-s"><span class="pl-pds">'</span>&lt;html&gt;&lt;body&gt;&lt;script&gt;alert(location.href);&lt;/body&gt;&lt;/html&gt;<span class="pl-pds">'</span></span>) <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\'</span><span class="pl-pds">'</span></span>;</span>
<span class="pl-s1">  <span class="pl-c">// iframe.src = 'javascript:;"' + encodeURI((html_tag).replace(/\"/g, '\\\"')) + '"';</span></span>
<span class="pl-s1">  <span class="pl-c1">document</span>.<span class="pl-c1">body</span>.<span class="pl-c1">appendChild</span>(iframe);</span>
<span class="pl-s1">  <span class="pl-c">// alert "about:blank"</span></span>
<span class="pl-s1">&lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<h3>
<a id="script-jsonp" class="anchor" href="#script-jsonp" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Script jsonp</h3>

<p>This is the case that your server needs to response JavaScript code and let the client browser execute it.
Just include the JS script link.</p>

<div class="highlight highlight-source-js"><pre>  (<span class="pl-k">function</span> () {
    <span class="pl-k">var</span> s <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>);
    <span class="pl-smi">s</span>.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>text/javascript<span class="pl-pds">'</span></span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">async</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
    <span class="pl-smi">s</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>/yourscript?some=parameter&amp;callback=jsonpCallback<span class="pl-pds">'</span></span>;
    <span class="pl-k">var</span> x <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];
    <span class="pl-smi">x</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(s, x);
  })();</pre></div>

<p>Know more about jsonp</p>

<ol>
<li>JSONP only works in GET HTTP request.</li>
<li>JSONP lacks error handling, means you cannot detect case in response status code 404, 500 and so on.</li>
<li>JSONP requests are always asynchronous.</li>
<li>Beware of CSRF attack.</li>
<li>Cross domain communication. Script response side (server-side) don't need to care about CORS.</li>
</ol>

<h3>
<a id="navigatorsendbeacon" class="anchor" href="#navigatorsendbeacon" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Navigator.sendBeacon()</h3>

<p>Look at the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon">documentation</a>.</p>

<blockquote>
<p>This method addresses the needs of analytics and diagnostics code that typically attempt to send data to a web server prior to the unloading of the document. Sending the data any sooner may result in a missed opportunity to gather data. However, ensuring that the data has been sent during the unloading of a document is something that has traditionally been difficult for developers.</p>
</blockquote>

<p>Send POST beacon through the API. It's cool.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">navigator</span>.<span class="pl-en">sendBeacon</span>(<span class="pl-s"><span class="pl-pds">"</span>/log<span class="pl-pds">"</span></span>, analyticsData);</pre></div>

<h3>
<a id="xmlhttprequest" class="anchor" href="#xmlhttprequest" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>XMLHttpRequest</h3>

<p>Writing XMLHttpRequest is not a good idea. I assume that you don't want to waste time on battling with IE or other browsers. Here's some polyfills or code you can try</p>

<ol>
<li>
<a href="https://github.com/github/fetch">window.fetch</a> - A window.fetch JavaScript polyfill.</li>
<li>
<a href="https://github.com/sindresorhus/got">got</a> - Simplified HTTP/HTTPS requests</li>
<li>
<a href="http://microjs.com/#ajax">microjs</a> - list of ajax lib</li>
<li>more</li>
</ol>

<h3>
<a id="fragment-identifier" class="anchor" href="#fragment-identifier" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Fragment Identifier</h3>

<p>Also known as hash mark <code>#</code>. Remember that request with hash mark at the end is not pass within http request.</p>

<p>For example, you are in the page <code>http://github.com/awesome#huei90</code></p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Sending a request with a parameter url which contains current url</span>
(<span class="pl-k">new</span> <span class="pl-en">Image</span>()).<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://yourrequest.com?url=http://github.com/awesome#huei90<span class="pl-pds">'</span></span>;

<span class="pl-c">// actual request will be without #</span>
(<span class="pl-k">new</span> <span class="pl-en">Image</span>()).<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://yourrequest.com?url=http://github.com/awesome<span class="pl-pds">'</span></span>;

<span class="pl-c">// Solved, encodeURIComponent(url);</span>
(<span class="pl-k">new</span> <span class="pl-en">Image</span>()).<span class="pl-smi">src</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://yourrequest.com?url=<span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-c1">encodeURIComponent</span>(<span class="pl-s"><span class="pl-pds">'</span>http://github.com/awesome#huei90<span class="pl-pds">'</span></span>);</pre></div>

<h3>
<a id="maximum-number-of-connection" class="anchor" href="#maximum-number-of-connection" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Maximum Number of Connection</h3>

<p>Check the maximum number of browser's request connection. <a href="http://www.browserscope.org/?category=network&amp;v=top">browserscope</a></p>

<h2 align="center">
<a id="-" class="anchor" href="#-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>
 <img src="https://cloud.githubusercontent.com/assets/2560096/9082891/ac4dc26e-3b99-11e5-8178-606270a801c4.png" alt="max number of connection">
</h2>

<h2>
<a id="component-of-uri" class="anchor" href="#component-of-uri" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Component of URI</h2>

<p>It's important to know if your SDK needs to parse the location url.</p>

<pre><code>                         authority
                   __________|_________
                  /                    \
              userinfo                host                          resource
               __|___                ___|___                 __________|___________
              /      \              /       \               /                      \
         username  password     hostname    port     path &amp; segment      query   fragment
           __|___   __|__    ______|______   |   __________|_________   ____|____   |
          /      \ /     \  /             \ / \ /                    \ /         \ / \
    foo://username:password@www.example.com:123/hello/world/there.html?name=ferret#foo
    \_/                     \ / \       \ /    \__________/ \     \__/
     |                       |   \       |           |       \      |
  scheme               subdomain  \     tld      directory    \   suffix
                                   \____/                      \___/
                                      |                          |
                                    domain                   filename
</code></pre>

<h3>
<a id="parsing-uri" class="anchor" href="#parsing-uri" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parsing URI</h3>

<p>Here's a simplest by using the native URL() Interface but it doesn't support all the browsers also <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/URL">not standard yet</a>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> parser <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">URL</span>(<span class="pl-s"><span class="pl-pds">'</span>http://github.com/huei90<span class="pl-pds">'</span></span>);
<span class="pl-smi">parser</span>.<span class="pl-c1">hostname</span>; <span class="pl-c">// =&gt; "github.com"</span></pre></div>

<p>For the browser which doesn't have the URL() Interface, try DOM createElement('a').</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> parser <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>);
<span class="pl-smi">parser</span>.<span class="pl-c1">href</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://github.com/huei90<span class="pl-pds">"</span></span>;
<span class="pl-smi">parser</span>.<span class="pl-c1">hostname</span>; <span class="pl-c">// =&gt; "github.com"</span></pre></div>

<h2>
<a id="debugging" class="anchor" href="#debugging" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Debugging</h2>

<h3>
<a id="simulating-multiple-domains" class="anchor" href="#simulating-multiple-domains" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Simulating Multiple Domains</h3>

<p>You don't need to register different domain names to simulate multiple domain, you can just edit your operating system's hosts file.</p>

<div class="highlight highlight-source-shell"><pre>$ sudo vim /etc/hosts</pre></div>

<p>Add the following entries</p>

<div class="highlight highlight-source-shell"><pre><span class="pl-c"># refer to localhost</span>
127.0.0.1 publisher.net
127.0.0.1 sdk.net</pre></div>

<p>Then you can access the page <code>http://publisher.net</code> and <code>http://sdk.net</code></p>

<h3>
<a id="developer-tools" class="anchor" href="#developer-tools" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Developer Tools</h3>

<p>Use the web debugging tools from browser vendors when debugging your SDK JavaScript code - <code>Chrome Developer Tools</code> <code>Safari Developer Tools</code> <code>Firebug</code>. Developer tools also short for DevTools.</p>

<blockquote>
<p>The DevTools provide web developers deep access into the internals of the browser and their web application. Use the DevTools to efficiently track down layout issues, set JavaScript breakpoints, and get insights for code optimization.</p>
</blockquote>

<h3>
<a id="console-logs" class="anchor" href="#console-logs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Console Logs</h3>

<p>For testing expected output text and other general debugging, <code>Console Logs</code> can be used throught the browser API <code>console.log()</code>. There are various typeways to format and output your messages, find out more <a href="https://developer.mozilla.org/en/docs/Web/API/console">Console API</a>.</p>

<p><img src="https://cloud.githubusercontent.com/assets/2560096/8155377/411fb24a-1376-11e5-98da-f71f8ed29bcd.png" alt="screen shot 2015-06-15 at 3 50 23 pm"></p>

<h3>
<a id="debugging-proxy" class="anchor" href="#debugging-proxy" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Debugging Proxy</h3>

<p>Sometimes debugging proxy will give you a hand on testing your SDK. Debug traffic, modify cookies, headers, cache, edit http request/response, SSL Proxying, ajax debugging and more.</p>

<p>Here's some software you can try</p>

<ul>
<li><a href="http://www.telerik.com/fiddler/fiddlercore">FiddlerCore</a></li>
<li><a href="http://www.charlesproxy.com">Charles</a></li>
<li><a href="https://itunes.apple.com/tw/app/cellist-http-debugging-proxy/id897814548?l=zh&amp;mt=12">Cellist</a></li>
</ul>

<h3>
<a id="browsersync" class="anchor" href="#browsersync" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>BrowserSync</h3>

<p><a href="http://www.browsersync.io">BrowserSync</a> makes your tweaking and testing faster by synchronising file changes and interactions across multiple devices. It’s wicked-fast and totally free.</p>

<p>It really helps a lot if you need to test your SDK result in multiple cross devices. Try it =)</p>

<h2>
<a id="tips-and-tricks" class="anchor" href="#tips-and-tricks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tips and Tricks</h2>

<h3>
<a id="piggyback" class="anchor" href="#piggyback" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Piggyback</h3>

<p>Sometimes, we don't want our developers include all the SDK source,
we just need to do a simple 1x1 pixel request (for example: return a request when landing on thank you/last page). All we need to do is ask the developer to include an image file with our url link.</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">img</span> <span class="pl-e">height</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> <span class="pl-e">width</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> <span class="pl-e">alt</span>=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">"</span>display:none<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>https://yourUrlLink.com/t?timestamp=1234567890<span class="pl-ii">&amp;</span>type=page1<span class="pl-ii">&amp;</span>currency=USD<span class="pl-ii">&amp;</span>noscript=1<span class="pl-pds">"</span></span> /&gt;</pre></div>

<h3>
<a id="page-visibility-api" class="anchor" href="#page-visibility-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Page Visibility API</h3>

<p>Sometimes, your SDK wants to detect if the user has your page in focus. Try the polyfills  <a href="https://github.com/addyosmani/visibly.js">visibly.js</a> and <a href="https://github.com/ai/visibilityjs">visibilityjs</a>.</p>

<h3>
<a id="document-referrer" class="anchor" href="#document-referrer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Document Referrer</h3>

<p>Use <code>document.referrer</code> to get the url of current previous page. But remember that this referrer is "Browser Referrer" not the "Human Known Referrer". If you click the <strong>browser back button</strong>, for example pageA -&gt; pageB -&gt; pageC -&gt; (back button) pageB, current pageB's referrer is pageA, not pageC.</p>

<h3>
<a id="console-logs-polyfill" class="anchor" href="#console-logs-polyfill" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Console Logs Polyfill</h3>

<p>It's not a real polyfill, just make sure that calling <code>console.log</code> API doesn't throw error event to client side.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">if</span> (<span class="pl-k">typeof</span> <span class="pl-en">console</span> <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">"</span>undefined<span class="pl-pds">"</span></span>) {
    <span class="pl-k">var</span> <span class="pl-en">f</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {};
    <span class="pl-en">console</span> <span class="pl-k">=</span> {
        log<span class="pl-k">:</span> f,
        debug<span class="pl-k">:</span> f,
        error<span class="pl-k">:</span> f,
        info<span class="pl-k">:</span> f
    };
}</pre></div>

<h3>
<a id="encodeuri-or-encodeuricomponent" class="anchor" href="#encodeuri-or-encodeuricomponent" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EncodeURI or EncodeURIComponent</h3>

<p>Understand the difference between <code>escape()</code> <code>encodeURI()</code> <code>encodeURIComponent()</code> <a href="http://stackoverflow.com/a/3608791/1748884">here</a>.</p>

<p>Remember that using <code>encodeURI()</code> and <code>encodeURIComponent()</code> has exactly 11 characters difference.
These characters are: # $ &amp; + , / : ; = ? @ <a href="http://stackoverflow.com/a/23842171/1748884">more discussion</a>.</p>

<h2 align="center">
<a id="--1" class="anchor" href="#--1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>
 <img src="http://i.imgur.com/rHWC1r1.png" alt="encodeuri or encodeuricomponent">
</h2>

<h3>
<a id="you-might-not-need-jquery" class="anchor" href="#you-might-not-need-jquery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>YOU MIGHT NOT NEED JQUERY</h3>

<p>As the title said, <a href="http://youmightnotneedjquery.com/">you might not need jquery</a>. It's really useful if you are looking for some utilities code - <a href="http://youmightnotneedjquery.com/#AJAX">AJAX</a> <a href="http://youmightnotneedjquery.com/#effects">EFFECTS</a>, <a href="http://youmightnotneedjquery.com/#elements">ELEMENTS</a>, <a href="http://youmightnotneedjquery.com/#events">EVENTS</a>, <a href="http://youmightnotneedjquery.com/#utils">UTILS</a></p>

<h3>
<a id="you-dont-need-jquery" class="anchor" href="#you-dont-need-jquery" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>You Don't Need jQuery</h3>

<blockquote>
<p>Free yourself from the chains of jQuery by embracing and understanding the modern Web API and discovering various directed libraries to help you fill in the gaps.</p>
</blockquote>

<p><a href="http://blog.garstasio.com/you-dont-need-jquery/">http://blog.garstasio.com/you-dont-need-jquery/</a></p>

<p>Useful Tips</p>

<ol>
<li><a href="http://blog.garstasio.com/you-dont-need-jquery/selectors/">Selecting Elements</a></li>
<li><a href="http://blog.garstasio.com/you-dont-need-jquery/dom-manipulation/">DOM Manipulation</a></li>
</ol>

<h3>
<a id="load-script-with-callback" class="anchor" href="#load-script-with-callback" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Load Script with Callback</h3>

<p>It's similar to <a href="#asynchronous-syntax">asynchrnous script loading</a> with addition callback event</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">loadScript</span>(<span class="pl-smi">url</span>, <span class="pl-smi">callback</span>) {
  <span class="pl-k">var</span> script <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">createElement</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>);
  <span class="pl-smi">script</span>.<span class="pl-smi">async</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
  <span class="pl-smi">script</span>.<span class="pl-smi">src</span> <span class="pl-k">=</span> url;

  <span class="pl-k">var</span> entry <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementsByTagName</span>(<span class="pl-s"><span class="pl-pds">'</span>script<span class="pl-pds">'</span></span>)[<span class="pl-c1">0</span>];
  <span class="pl-smi">entry</span>.<span class="pl-c1">parentNode</span>.<span class="pl-c1">insertBefore</span>(script, entry);

  <span class="pl-smi">script</span>.<span class="pl-smi">onload</span> <span class="pl-k">=</span> <span class="pl-smi">script</span>.<span class="pl-en">onreadystatechange</span> <span class="pl-k">=</span> <span class="pl-k">function</span> () {
    <span class="pl-k">var</span> rdyState <span class="pl-k">=</span> <span class="pl-smi">script</span>.<span class="pl-c1">readyState</span>;

    <span class="pl-k">if</span> (<span class="pl-k">!</span>rdyState <span class="pl-k">||</span><span class="pl-sr"> <span class="pl-pds">/</span>complete<span class="pl-k">|</span>loaded<span class="pl-pds">/</span></span>.<span class="pl-c1">test</span>(<span class="pl-smi">script</span>.<span class="pl-c1">readyState</span>)) {
      <span class="pl-en">callback</span>();

      <span class="pl-c">// detach the event handler to avoid memory leaks in IE (http://mng.bz/W8fx)</span>
      <span class="pl-smi">script</span>.<span class="pl-smi">onload</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
      <span class="pl-smi">script</span>.<span class="pl-c1">onreadystatechange</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
    }
  };
}</pre></div>

<h3>
<a id="once-function" class="anchor" href="#once-function" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Once Function</h3>

<p>Implementation of the function <code>once</code></p>

<blockquote>
<p>Every so often you have a function which you only want to run once.  Oftentimes these functions are in the form of event listeners which may be difficult to manage.  Of course if they were easy to manage, you'd just remove the listeners but that's a perfect world and sometimes you simply want the ability to only allow a function to be called once.  Here's the JavaScript function to make that possible!</p>
</blockquote>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// Copy from DWB</span>
<span class="pl-c">// http://davidwalsh.name/javascript-once</span>
<span class="pl-k">function</span> <span class="pl-en">once</span>(<span class="pl-smi">fn</span>, <span class="pl-smi">context</span>) { 
    <span class="pl-k">var</span> result;

    <span class="pl-k">return</span> <span class="pl-k">function</span>() { 
        <span class="pl-k">if</span>(fn) {
            result <span class="pl-k">=</span> <span class="pl-smi">fn</span>.<span class="pl-c1">apply</span>(context <span class="pl-k">||</span> <span class="pl-v">this</span>, <span class="pl-v">arguments</span>);
            fn <span class="pl-k">=</span> <span class="pl-c1">null</span>;
        }

        <span class="pl-k">return</span> result;
    };
}

<span class="pl-c">// Usage</span>
<span class="pl-k">var</span> canOnlyFireOnce <span class="pl-k">=</span> <span class="pl-en">once</span>(<span class="pl-k">function</span>() {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>Fired!<span class="pl-pds">'</span></span>);
});

<span class="pl-en">canOnlyFireOnce</span>(); <span class="pl-c">// "Fired!"</span>
<span class="pl-en">canOnlyFireOnce</span>(); <span class="pl-c">// nada</span></pre></div>

<h3>
<a id="pixel-ratio-density" class="anchor" href="#pixel-ratio-density" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Pixel Ratio Density</h3>

<p>If you stuck on the term pixel, ratio, density, dimension, what while developing mobile web, try understanding the video, it may help.</p>

<p><a href="https://www.youtube.com/watch?v=u0rfDeaxehc">Device pixel ratio - Mobile Web Development</a> <br>
<a href="https://www.youtube.com/watch?t=34&amp;v=UUF4jD-xoYc">Mobile device pixels - Mobile Web Development</a></p>

<h3>
<a id="get-style-value" class="anchor" href="#get-style-value" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get Style Value</h3>

<p><strong>Get inline-style value</strong></p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">span</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">"</span>color: black<span class="pl-pds">"</span></span>&gt; This is black color span &lt;/<span class="pl-ent">span</span>&gt;
<span class="pl-s1">&lt;<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">    <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>black<span class="pl-pds">'</span></span>).<span class="pl-c1">style</span>.<span class="pl-c1">color</span>; <span class="pl-c">// =&gt; black</span></span>
<span class="pl-s1">&lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<p><strong>Get Real style value</strong></p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">&lt;<span class="pl-ent">style</span>&gt;</span>
<span class="pl-s1"><span class="pl-e">#black</span> {</span>
<span class="pl-s1">    <span class="pl-c1"><span class="pl-c1">color</span></span>: <span class="pl-c1">red</span> <span class="pl-k">!important</span>;</span>
<span class="pl-s1">}</span>
<span class="pl-s1">&lt;/<span class="pl-ent">style</span>&gt;</span>

&lt;<span class="pl-ent">span</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>black<span class="pl-pds">"</span></span> <span class="pl-e">style</span>=<span class="pl-s"><span class="pl-pds">"</span>color: black<span class="pl-pds">"</span></span>&gt; This is black color span &lt;/<span class="pl-ent">span</span>&gt;

<span class="pl-s1">&lt;<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">    <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>black<span class="pl-pds">'</span></span>).<span class="pl-c1">style</span>.<span class="pl-c1">color</span>; <span class="pl-c">// =&gt; black</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">// real</span></span>
<span class="pl-s1">    <span class="pl-k">var</span> black <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>black<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-c1">window</span>.<span class="pl-en">getComputedStyle</span>(black, <span class="pl-c1">null</span>).<span class="pl-en">getPropertyValue</span>(<span class="pl-s"><span class="pl-pds">'</span>color<span class="pl-pds">'</span></span>); <span class="pl-c">// =&gt; rgb(255, 0, 0)</span></span>
<span class="pl-s1">&lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<p>ref: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle">https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle</a></p>

<h3>
<a id="check-if-element-in-viewport" class="anchor" href="#check-if-element-in-viewport" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check if Element in Viewport</h3>

<p>You can find out more <a href="http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport/7557433#7557433">here</a>.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">isElementInViewport</span> (<span class="pl-smi">el</span>) {

    <span class="pl-c">//special bonus for those using jQuery</span>
    <span class="pl-k">if</span> (<span class="pl-k">typeof</span> jQuery <span class="pl-k">===</span> <span class="pl-s"><span class="pl-pds">"</span>function<span class="pl-pds">"</span></span> <span class="pl-k">&amp;&amp;</span> el <span class="pl-k">instanceof</span> jQuery) {
        el <span class="pl-k">=</span> el[<span class="pl-c1">0</span>];
    }

    <span class="pl-k">var</span> rect <span class="pl-k">=</span> <span class="pl-smi">el</span>.<span class="pl-c1">getBoundingClientRect</span>();

    <span class="pl-k">return</span> (
        <span class="pl-smi">rect</span>.<span class="pl-c1">top</span> <span class="pl-k">&gt;=</span> <span class="pl-c1">0</span> <span class="pl-k">&amp;&amp;</span>
        <span class="pl-smi">rect</span>.<span class="pl-c1">left</span> <span class="pl-k">&gt;=</span> <span class="pl-c1">0</span> <span class="pl-k">&amp;&amp;</span>
        <span class="pl-smi">rect</span>.<span class="pl-c1">bottom</span> <span class="pl-k">&lt;=</span> (<span class="pl-c1">window</span>.<span class="pl-c1">innerHeight</span> <span class="pl-k">||</span> <span class="pl-c1">document</span>.<span class="pl-c1">documentElement</span>.<span class="pl-smi">clientHeight</span>) <span class="pl-k">&amp;&amp;</span> <span class="pl-c">/*or $(window).height() */</span>
        <span class="pl-smi">rect</span>.<span class="pl-c1">right</span> <span class="pl-k">&lt;=</span> (<span class="pl-c1">window</span>.<span class="pl-c1">innerWidth</span> <span class="pl-k">||</span> <span class="pl-c1">document</span>.<span class="pl-c1">documentElement</span>.<span class="pl-smi">clientWidth</span>) <span class="pl-c">/*or $(window).width() */</span>
    );
}</pre></div>

<h3>
<a id="check-if-element-is-visible" class="anchor" href="#check-if-element-is-visible" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check if Element is Visible</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">isVisible</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">b</span>) {
    <span class="pl-k">var</span> a <span class="pl-k">=</span> <span class="pl-c1">window</span>.<span class="pl-en">getComputedStyle</span>(b);
    <span class="pl-k">return</span> <span class="pl-c1">0</span> <span class="pl-k">===</span> <span class="pl-smi">a</span>.<span class="pl-en">getPropertyValue</span>(<span class="pl-s"><span class="pl-pds">"</span>opacity<span class="pl-pds">"</span></span>) <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>none<span class="pl-pds">"</span></span> <span class="pl-k">===</span> <span class="pl-smi">a</span>.<span class="pl-en">getPropertyValue</span>(<span class="pl-s"><span class="pl-pds">"</span>display<span class="pl-pds">"</span></span>) <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>hidden<span class="pl-pds">"</span></span> <span class="pl-k">===</span> <span class="pl-smi">a</span>.<span class="pl-en">getPropertyValue</span>(<span class="pl-s"><span class="pl-pds">"</span>visibility<span class="pl-pds">"</span></span>) <span class="pl-k">||</span> <span class="pl-c1">0</span> <span class="pl-k">===</span> <span class="pl-c1">parseInt</span>(<span class="pl-smi">b</span>.<span class="pl-c1">style</span>.<span class="pl-smi">opacity</span>, <span class="pl-c1">10</span>) <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>none<span class="pl-pds">"</span></span> <span class="pl-k">===</span> <span class="pl-smi">b</span>.<span class="pl-c1">style</span>.<span class="pl-c1">display</span> <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>hidden<span class="pl-pds">"</span></span> <span class="pl-k">===</span> <span class="pl-smi">b</span>.<span class="pl-c1">style</span>.<span class="pl-c1">visibility</span> <span class="pl-k">?</span> <span class="pl-c1">false</span> <span class="pl-k">:</span> <span class="pl-c1">true</span>;
}

<span class="pl-k">var</span> element <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>box<span class="pl-pds">'</span></span>);
<span class="pl-en">isVisible</span>(element); <span class="pl-c">// =&gt; false or true</span></pre></div>

<h3>
<a id="get-viewport-size" class="anchor" href="#get-viewport-size" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get Viewport Size</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">getViewportSize</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
    <span class="pl-k">try</span> {
        <span class="pl-k">var</span> doc <span class="pl-k">=</span> <span class="pl-smi">top</span>.<span class="pl-smi">document</span>.<span class="pl-c1">documentElement</span>
          , g <span class="pl-k">=</span> (e <span class="pl-k">=</span> <span class="pl-smi">top</span>.<span class="pl-smi">document</span>.<span class="pl-c1">body</span>) <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">top</span>.<span class="pl-smi">document</span>.<span class="pl-smi">clientWidth</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">top</span>.<span class="pl-smi">document</span>.<span class="pl-smi">clientHeight</span>;
    } <span class="pl-k">catch</span> (e) {
        <span class="pl-k">var</span> doc <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">documentElement</span>
          , g <span class="pl-k">=</span> (e <span class="pl-k">=</span> <span class="pl-c1">document</span>.<span class="pl-c1">body</span>) <span class="pl-k">&amp;&amp;</span> <span class="pl-c1">document</span>.<span class="pl-smi">clientWidth</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-c1">document</span>.<span class="pl-smi">clientHeight</span>;
    }
    <span class="pl-k">var</span> vp <span class="pl-k">=</span> [];
    doc <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">doc</span>.<span class="pl-smi">clientWidth</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">doc</span>.<span class="pl-smi">clientHeight</span> <span class="pl-k">&amp;&amp;</span> (<span class="pl-s"><span class="pl-pds">"</span>CSS1Compat<span class="pl-pds">"</span></span> <span class="pl-k">===</span> <span class="pl-c1">document</span>.<span class="pl-smi">compatMode</span> <span class="pl-k">||</span> <span class="pl-k">!</span>g) <span class="pl-k">?</span> vp <span class="pl-k">=</span> [<span class="pl-smi">doc</span>.<span class="pl-smi">clientWidth</span>, <span class="pl-smi">doc</span>.<span class="pl-smi">clientHeight</span>] <span class="pl-k">:</span> g <span class="pl-k">&amp;&amp;</span> (vp <span class="pl-k">=</span> [<span class="pl-smi">doc</span>.<span class="pl-smi">clientWidth</span>, <span class="pl-smi">doc</span>.<span class="pl-smi">clientHeight</span>]);
    <span class="pl-k">return</span> vp;
}

<span class="pl-c">// return as rray [viewport_width, viewport_height]</span></pre></div>

<h2>
<a id="wtf" class="anchor" href="#wtf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WTF</h2>

<h3>
<a id="misspelling-of-referrer" class="anchor" href="#misspelling-of-referrer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Misspelling Of Referrer</h3>

<p>Do you know that why the HTTP Request Header having the field name <code>referer</code> not <code>referrer</code></p>

<p><em>According to the <a href="https://en.wikipedia.org/wiki/HTTP_referer#Etymology">Wikipedia</a></em></p>

<blockquote>
<p>The <code>misspelling of referrer</code> originated in the original proposal by computer scientist <code>Phillip Hallam-Baker</code> to incorporate the field into the HTTP specification. The misspelling was set in stone by the time of its incorporation into the <code>Request for Comments</code> standards document <code>RFC 1945</code>; document co-author <code>Roy Fielding</code> has remarked that neither "referrer" nor the misspelling "referer" were recognized by the standard <code>Unix spell checker</code> of the period. "Referer" has since become a widely used spelling in the industry when discussing HTTP referrers; usage of the misspelling is not universal, though, as the correct spelling "referrer" is used in some web specifications such as the <code>Document Object Model</code>.</p>
</blockquote>

<h2 align="center">
<a id="----" class="anchor" href="#----" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>
    <img src="https://cloud.githubusercontent.com/assets/2560096/12190613/96a7d652-b605-11e5-8109-1c6fefa9dfc4.png">
</h2>

<h2>
<a id="template" class="anchor" href="#template" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Template</h2>

<p>Someone asks for the template/boilerplate of the SDK, here some examples for you. <a href="https://github.com/huei90/JavaScript-sdk-design/blob/master/Template/README.md">TEMPLATE.md</a></p>

<h2>
<a id="booknice-to-read" class="anchor" href="#booknice-to-read" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Book/Nice to Read</h2>

<ol>
<li><a href="http://thirdpartyjs.com">Third-Party JavaScript</a></li>
<li><a href="https://learn.jquery.com/plugins/">JQuery Plugin</a></li>
<li><a href="https://github.com/olark/lightningjs">LightningJS</a></li>
</ol>

<h2>
<a id="reference" class="anchor" href="#reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reference</h2>

<ol>
<li><a href="http://www.webopedia.com/TERM/S/SDK.html">What is Software Development Kit</a></li>
<li><a href="https://github.com/github/fetch">A window.fetch JavaScript polyfill.</a></li>
<li><a href="http://stackoverflow.com/questions/692196/post-request-JavaScript/25423688#25423688">POST Request</a></li>
<li><a href="http://semver.org">Semantic VersioningVersioning 2.0.0</a></li>
<li><a href="https://github.com/interagent/http-api-design">HTTP API design guide extracted from work on the Heroku Platform API</a></li>
<li><a href="http://medialize.github.io/URI.js/about-uris.html">Understanding URIs</a></li>
<li><a href="https://gist.github.com/jlong/2428561">URI Parsing with JavaScript</a></li>
<li><a href="http://modernizr.com">Modernizr: the feature detection library for HTML5/CSS3</a></li>
<li><a href="http://www.w3schools.com/html/html5_webstorage.asp">HTML5 Web Storage</a></li>
<li><a href="http://stackoverflow.com/questions/3550790/check-if-third-party-cookies-are-enabled">Check if third-party cookies are enabled</a></li>
<li><a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/">Introduction to Analytics.js - Universal Analytics Web Tracking</a></li>
<li><a href="https://www.facebook.com/help/421433191260652">Facebook Conversion Tracking Pixel</a></li>
<li><a href="http://www.boutell.com/newfaq/misc/urllength.html">What is the maximum length of a URL</a></li>
<li><a href="http://youmightnotneedjquery.com/">YOU MIGHT NOT NEED JQUERY</a></li>
<li><a href="https://remysharp.com/2010/10/08/what-is-a-polyfill">What is a Polyfill?</a></li>
<li><a href="http://peter.sh/experiments/asynchronous-and-deferred-javascript-execution-explained/">Asynchronous and deferred JavaScript execution explained</a></li>
<li><a href="https://gist.github.com/jed/982883">generate random UUIDs</a></li>
<li><a href="http://stackoverflow.com/questions/2414750/difference-between-domcontentloaded-and-load-events">DOMContentLoaded and Load Event</a></li>
<li><a href="https://medium.com/javascript-scene/must-see-javascript-dev-tools-that-put-other-dev-tools-to-shame-aca6d3e3d925">Must See JavaScript Dev Tools That Put Other Dev Tools to Shame</a></li>
<li><a href="https://github.com/noffle/art-of-readme">Learn the art of writing quality READMEs.</a></li>
</ol>

<p><em>(inspired by <a href="https://github.com/interagent/http-api-design">http-api-design</a>)</em></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/huei90/javascript-sdk-design">Javascript-sdk-design</a> is maintained by <a href="https://github.com/huei90">huei90</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-62313508-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
